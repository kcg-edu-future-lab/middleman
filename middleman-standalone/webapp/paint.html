<!DOCTYPE html>
<html lang="ja">
<head>
<meta encoding="utf-8">
<style>
body {
  padding: 10px;
}
#canvas{
  border: solid 1px;
}
</style>
<script src="middleman.js"></script>
</head>
<body>

<canvas id="canvas" width="640" height="480"></canvas>
<script>
class DrawCanvas{
	constructor(canvas){
		this.ctx = canvas.getContext("2d");
		canvas.addEventListener("mousedown", e => {
			this.dragging = true;
		});
		canvas.addEventListener("mouseup", e => {
			this.dragging = false;
		});
		canvas.addEventListener("mousemove", e => {
			if(this.dragging){
				this.draw(e.offsetX, e.offsetY);
			}
		});
	}

	draw(x, y){
		this.ctx.beginPath();
		this.ctx.arc(x, y, 2, 0, Math.PI*2, true);
		this.ctx.fill();
	}
}

window.addEventListener('load', () => {
	const canvas = new DrawCanvas(document.querySelector("#canvas"));

	const service = "simplePaint";
	const room = "2oir094";
	const m = new Middleman(service, room);
	canvas.draw = m.proxy(canvas.draw.bind(canvas));
});
</script>
</body>
</html>
